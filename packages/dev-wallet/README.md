## Dev Wallet Provider

## Endpoints That Matter

> **NOTE:** The actual urls dont really matter that much, its more that each exists somewhere. FCL is fairly flexible.

### The Challenge

> BROWSER/HTTP/GET /flow/authenticate

The challenge is responsible for the initial handshake between FCL and the wallet provider. FCL will either redirect to this url or open it in an iframe, including some query parameters.

The idea is the wallet provider will:
- Have the user prove who they are (authenticate/sign up/sign in with provider).
- Allow the user to pick which flow address to use (if any).
- FCL might have requested some additional information via a scope, all scopes are optional, so the user should decide which data the provider will share with the dApp.
- Send data back to FCL
  - javascript postMessage if in an iframe
  - redirect if not in an iframe

The data that needs to be sent back to FCL after a successful challenge is as follows:
- **type** - *(iframe only)* Always the string: `FLOW::AUTHN::RESP`
- **addr** - The flow address if it exists
- **paddr** - The providers flow address (address where provider contract lives (provider contract is not a thing that exist yet))
- **code** - Generated by the provider, will be passed back to the provider via a back channel hook request, the provider needs to be able use this value to know what scopes the user has allowed to share
- **exp** - When the code expires as a future epoch integer, lack of a value or a value of 0 will be taken as never expires.
- **hks** - Back channel that FCL will request the private Hooks from. FCL will include the `code` provided from above.
- **nonce** - A generated value FCL supplies in the challenge, it needs to be sent back to FCL unchanged.
- **l6n** - The location (origin) of the dApp. Used to scope the javascript postMessage. It also needs to be sent back to FCL unchanged.

![diagram showing current fcl authn and authz flow](./assets/FCL-AUTHN-AUTHZ-FLOWS-v2.png)
